[{
    "name": "Computers: Find all Domain Controllers",
    "category": "Computers",
    "queryList": [{
        "final": false,
        "query": "MATCH (g:Group) WHERE g.objectid ENDS WITH '-516' RETURN g.name"
        },{
        "final": true,
        "query": "MATCH p=(c:Computer)-[:MemberOf*1..]->(g:Group {name: $result})-[r1]->(:Domain) RETURN p",
        "allowCollapse": false
    }]
},{
    "name": "Computers: List all computers WITHOUT LAPS",
    "category": "Computers",
    "queryList": [{
        "final": true,
        "query": "MATCH (c:Computer {haslaps:false}) RETURN c ORDER BY c.name"
    }]
},{
    "name": "Computers: List all computers WITH LAPS",
    "category": "Computers",
    "queryList": [{
        "final": true,
        "query": "MATCH (c:Computer {haslaps:true}) RETURN c ORDER BY c.name"
    }]
},{
    "name": "Computers: Route all sessions to computers WITHOUT LAPS",
    "category": "Computers",
    "queryList": [{
        "final": true,
        "query": "MATCH p=(u:User)<-[r:HasSession]-(c:Computer {haslaps:false}) RETURN p ORDER BY c.name"
    }]
},{
    "name": "Computers: [DANGEROUS!!!] Route all Computers Dangerous Rights to any node type",
    "category": "Computers",
    "queryList": [{
        "final": true,
        "query": "MATCH (c:Computer), (u1:User), (g:Group), (gp:GPO), (co:Container), (ou:OU) WITH collect([c, u1, g, gp, co, ou]) AS t WITH t AS results UNWIND results AS results_2 UNWIND results_2 AS result MATCH p=(c2:Computer)-[r:Owns|WriteDacl|GenericAll|WriteOwner|ExecuteDCOM|AllowedToDelegate|ForceChangePassword|AdminTo]->(result) RETURN p"
    }]
}]
